import sys
import os
from pathlib import Path

# Add the parent directory to Python path so we can import from xdsl/dialects
sys.path.insert(0, str(Path(__file__).parent.parent))

from dialects import get_all_dialects
#from mqtop.xdsl.transforms import get_all_passes
from xdsl.xdsl_opt_main import xDSLOptMain


class QuoptMain(xDSLOptMain):
    def register_all_dialects(self):
        # First register the standard xDSL dialects
        super().register_all_dialects()
        
        # Then register our custom dialects
        for name, dialect in get_all_dialects().items():
            self.ctx.register_dialect(name, dialect)

    #def register_all_passes(self):
    #    for name, pass_ in get_all_passes().items():
    #        self.register_pass(name, pass_)

    def register_all_targets(self):
        super().register_all_targets()


def main():
    quopt_main = QuoptMain()
    quopt_main.run()


if "__main__" == __name__:
    main()
